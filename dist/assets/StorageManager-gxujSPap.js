import{j as e}from"./vendor-ui-BGGfvU-n.js";import{a as o}from"./vendor-react-BiKKw5Rc.js";import{a as m,f as b,C as A,d as k,e as D,n as M,b as B,B as h,J as l}from"./index-p40y1I9K.js";import{P as F}from"./progress-DZC4VRn8.js";import{storageUtils as c}from"./storageUtils-DyonkL-b.js";import{d as u}from"./dataStorage-ZXqbZ8jG.js";import{l as d}from"./logger-Bi5o39IC.js";import{D as T}from"./dataValidation-ZMBj8GTs.js";import{C as E}from"./circle-alert-C4zRNhqb.js";import{T as f}from"./trash-2-J27CM5os.js";import{C as I}from"./circle-check-big-DUkzVwRO.js";import"./3d-DUDogAyU.js";import"./vendor-utils-BNQKEpbf.js";import"./i18n-DNqVcHxj.js";const L=b("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x=o.forwardRef(({className:r,variant:t,...a},g)=>e.jsx("div",{ref:g,role:"alert",className:m(L({variant:t}),r),...a}));x.displayName="Alert";const R=o.forwardRef(({className:r,...t},a)=>e.jsx("h5",{ref:a,className:m("mb-1 font-medium leading-none tracking-tight",r),...t}));R.displayName="AlertTitle";const j=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:m("text-sm [&_p]:leading-relaxed",r),...t}));j.displayName="AlertDescription";const Y=()=>{const[r,t]=o.useState(c.getStorageInfo()),[a,g]=o.useState(u.getStorageStats()),p=()=>{t(c.getStorageInfo()),g(u.getStorageStats())},N=()=>{try{c.clearOldTrackingData(30),l.success("Old data cleared successfully"),p()}catch(s){d.error("Failed to clear old tracking data",s),l.error("Failed to clear old data")}},C=()=>{try{c.clearNonEssentialData(),l.success("Non-essential data cleared"),p()}catch(s){d.error("Failed to clear non-essential data",s),l.error("Failed to clear non-essential data")}},w=()=>{try{if(window.confirm("Are you sure you want to clear ALL data? This cannot be undone!"))try{u.clearAllData(),l.success("All data cleared"),window.location.replace("/")}catch(n){d.error("Failed to clear all data",n),l.error("Failed to clear all data")}}catch(s){d.error("Confirmation dialog failed",s),l.error("Could not show confirmation dialog")}},y=s=>{if(s===0)return"0 Bytes";const n=1024,S=["Bytes","KB","MB"],v=Math.floor(Math.log(s)/Math.log(n));return parseFloat((s/Math.pow(n,v)).toFixed(2))+" "+S[v]},i=r.used/5e6*100;return e.jsxs(A,{children:[e.jsxs(k,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Storage Management"]}),e.jsx(M,{children:"Manage your local storage to ensure smooth operation"})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Storage Usage"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Used"}),e.jsxs("span",{children:[y(r.used)," / ~5 MB"]})]}),e.jsx("div",{className:"w-full",children:e.jsx(F,{value:Math.min(i,100),className:"h-2"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Data Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:["Students: ",a.studentsCount]}),e.jsxs("div",{children:["Entries: ",a.entriesCount]}),e.jsxs("div",{children:["Goals: ",a.goalsCount]}),e.jsxs("div",{children:["Alerts: ",a.alertsCount]})]})]}),i>70&&e.jsxs(x,{className:m(i>90?"border-red-500":"border-yellow-500"),children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx(j,{children:i>90?"Storage is almost full! Clear some data to prevent errors.":"Storage usage is getting high. Consider clearing old data."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{variant:"outline",onClick:N,className:"w-full justify-start",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Clear data older than 30 days"]}),e.jsxs(h,{variant:"outline",onClick:C,className:"w-full justify-start",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Clear non-essential data"]}),e.jsxs(h,{variant:"destructive",onClick:w,className:"w-full justify-start",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Clear ALL data (irreversible)"]})]}),r.available&&e.jsxs(x,{className:"border-green-500",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(j,{children:"Storage is healthy with sufficient space available."})]})]})]})};export{Y as StorageManager};
