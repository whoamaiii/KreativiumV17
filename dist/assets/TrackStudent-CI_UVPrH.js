import{j as e}from"./vendor-ui-BGGfvU-n.js";import{a as r,j as Y,u as Q}from"./vendor-react-BiKKw5Rc.js";import{c as M,u as H,C as V,d as q,e as F,b as B,B as x,J as $}from"./index-p40y1I9K.js";import{T as J}from"./textarea-2v1IUrdg.js";import{B as L}from"./badge-XQGYYPGp.js";import{l as _}from"./logger-Bi5o39IC.js";import{Z as X,A as ee}from"./zap-DStDXklo.js";import{E as se}from"./eye-CGa4_C8K.js";import{H as te}from"./hand-DEREcSp_.js";import{R as ne,S as K}from"./slider-BzqSx8sm.js";import{L as A}from"./label-DPtwVyR_.js";import{S as O,a as U,b as z,c as P,d as S}from"./select-Df25Jq5p.js";import{T as Z}from"./thermometer-D8LnDntt.js";import{U as ae}from"./users-CUYC0DLd.js";import{P as re,U as ie}from"./user-CQXHlJDq.js";import{X as oe}from"./x-CtjkR7Fw.js";import{L as le}from"./LanguageSettings-DP-p1Cso.js";import{a as de}from"./analyticsManager-D5rdgc0M.js";import{A as ce}from"./arrow-left-DTqb6Oho.js";import{S as me}from"./save-C79c2pc2.js";import"./3d-DUDogAyU.js";import"./vendor-utils-BNQKEpbf.js";import"./i18n-DNqVcHxj.js";import"./check-JkTn6zF0.js";import"./dropdown-menu-7gruBPiX.js";import"./analyticsConfig-Di1mAdDI.js";import"./enhancedPatternAnalysis-BSzs8ls5.js";import"./ml-BTt1mEdE.js";import"./storageUtils-DyonkL-b.js";import"./dataStorage-ZXqbZ8jG.js";/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=M("Angry",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["path",{d:"M7.5 8 10 9",key:"olxxln"}],["path",{d:"m14 9 2.5-1",key:"1j6cij"}],["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=M("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=M("Ear",[["path",{d:"M6 8.5a6.5 6.5 0 1 1 13 0c0 6-6 6-6 10a3.5 3.5 0 1 1-7 0",key:"1dfaln"}],["path",{d:"M15 8.5a2.5 2.5 0 0 0-5 0v1a2 2 0 1 1 0 4",key:"1qnva7"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=M("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=M("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=M("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=M("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=M("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),ve=[{type:"happy",icon:fe,color:"emotion-happy"},{type:"calm",icon:pe,color:"emotion-calm"},{type:"excited",icon:X,color:"emotion-excited"},{type:"sad",icon:he,color:"emotion-sad"},{type:"anxious",icon:G,color:"emotion-anxious"},{type:"angry",icon:xe,color:"emotion-angry"}],W={happy:["joyful","content","cheerful","pleased","delighted"],calm:["peaceful","relaxed","serene","tranquil","centered"],excited:["energetic","enthusiastic","thrilled","eager","animated"],sad:["disappointed","lonely","grieving","melancholy","dejected"],anxious:["worried","nervous","fearful","stressed","panicked"],angry:["frustrated","irritated","furious","annoyed","resentful"]},je=({onEmotionAdd:I,studentId:k})=>{const{tTracking:t,tCommon:D}=H(),[a,C]=r.useState(""),[o,w]=r.useState(""),[d,E]=r.useState(3),[f,N]=r.useState(0),[u,v]=r.useState("unknown"),[l,p]=r.useState(""),[c,m]=r.useState([]),[g,b]=r.useState(""),i=()=>{g.trim()&&!c.includes(g.trim())&&(m([...c,g.trim()]),b(""))},T=n=>{m(c.filter(s=>s!==n))},j=()=>{if(!a){_.warn("Attempted to submit emotion without selection");return}I({studentId:k,emotion:a,subEmotion:o||void 0,intensity:d,duration:f>0?f:void 0,escalationPattern:u!=="unknown"?u:void 0,notes:l.trim()||void 0,triggers:c.length>0?c:void 0}),C(""),w(""),E(3),N(0),v("unknown"),p(""),m([])};return e.jsxs(V,{className:"font-dyslexia bg-gradient-card border-0",children:[e.jsx(q,{children:e.jsx(F,{className:"text-xl text-foreground",children:String(t("emotions.title"))})}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:String(t("emotions.selectEmotion"))}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:ve.map(n=>{const s=n.icon;return e.jsxs(x,{variant:a===n.type?"default":"outline",className:`h-20 flex-col gap-2 font-dyslexia hover-lift press-scale transition-all duration-300 ${a===n.type?"bg-gradient-primary shadow-glow animate-bounce-in":"hover:scale-105 animate-fade-in hover:shadow-soft"}`,onClick:()=>C(n.type),"aria-label":`Select ${String(t(`emotions.types.${n.type}`))}`,"aria-pressed":a===n.type,children:[e.jsx(s,{className:"h-6 w-6 transform transition-transform duration-200 hover:scale-110"}),e.jsx("span",{className:"text-sm",children:String(t(`emotions.types.${n.type}`))})]},n.type)})})]}),a&&W[a]&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Specific Feeling (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W[a].map(n=>e.jsx(L,{variant:o===n?"default":"outline",className:"cursor-pointer font-dyslexia hover-lift transition-all duration-200",onClick:()=>w(o===n?"":n),role:"button",tabIndex:0,"aria-pressed":o===n,"aria-label":`Select ${n}`,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),w(o===n?"":n))},children:n},n))})]}),a&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-foreground mb-3",children:[String(t("emotions.intensity")),": ",d,"/5"]}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(n=>e.jsx(x,{variant:d===n?"default":"outline",size:"sm",className:`w-12 h-12 rounded-full font-dyslexia hover-lift press-scale transition-all duration-200 hover:shadow-soft ${d===n?"bg-gradient-primary animate-bounce-in":""}`,onClick:()=>E(n),title:String(t(`emotions.intensityLevels.${n}`)),"aria-label":`Intensity level ${n}`,"aria-pressed":d===n,children:n},n))})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Duration (minutes)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:f,onChange:n=>{const s=n.target.value;if(s===""){N(0);return}const y=parseInt(s,10);isNaN(y)||N(Math.max(0,Math.min(999,y)))},placeholder:"How long did it last?",className:"w-32 px-3 py-2 border border-border rounded-lg font-dyslexia bg-input focus:ring-2 focus:ring-ring focus:border-transparent",min:"0",max:"999","aria-label":"Duration in minutes","aria-describedby":"duration-help"}),e.jsx("div",{className:"flex gap-1",children:[5,15,30,60].map(n=>e.jsx(x,{variant:"outline",size:"sm",onClick:()=>N(n),className:"font-dyslexia",children:n<60?`${n}m`:"1h"},n))})]})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"How did it develop?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:u==="sudden"?"default":"outline",size:"sm",onClick:()=>v("sudden"),className:"font-dyslexia",children:"Sudden"}),e.jsx(x,{variant:u==="gradual"?"default":"outline",size:"sm",onClick:()=>v("gradual"),className:"font-dyslexia",children:"Gradual"}),e.jsx(x,{variant:u==="unknown"?"default":"outline",size:"sm",onClick:()=>v("unknown"),className:"font-dyslexia",children:"Unknown"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Utløsere (Valgfritt)"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:g,onChange:n=>b(n.target.value),onKeyPress:n=>n.key==="Enter"&&i(),placeholder:"Legg til en utløser...",className:"flex-1 px-3 py-2 border border-border rounded-lg font-dyslexia bg-input focus:ring-2 focus:ring-ring focus:border-transparent"}),e.jsx(x,{onClick:i,size:"sm",variant:"outline",children:String(D("buttons.add"))})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(n=>e.jsxs(L,{variant:"secondary",className:"font-dyslexia cursor-pointer",onClick:()=>T(n),children:[n," ×"]},n))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:String(t("emotions.notes"))}),e.jsx(J,{value:l,onChange:n=>p(n.target.value),placeholder:"Ytterligere observasjoner...",className:"font-dyslexia bg-input border-border focus:ring-ring",rows:3})]}),e.jsx(x,{onClick:j,disabled:!a,className:"w-full font-dyslexia bg-gradient-primary hover:opacity-90 transition-all duration-200",children:String(t("emotions.addEmotion"))})]})]})},Se=[{type:"visual",icon:se},{type:"auditory",icon:ge},{type:"tactile",icon:te},{type:"vestibular",icon:ne},{type:"proprioceptive",icon:ee}],Ne=[{type:"seeking"},{type:"avoiding"},{type:"neutral"},{type:"overwhelmed"}],be=["Head","Eyes","Ears","Mouth","Neck","Shoulders","Arms","Hands","Chest","Back","Stomach","Legs","Feet"],we=["Deep breathing","Take a break","Use fidget tool","Movement break","Quiet space","Headphones","Weighted blanket","Sensory walk","Compression","Joint compressions","Chewing gum","Water break"],ke=({onSensoryAdd:I,studentId:k})=>{const{tTracking:t,tCommon:D}=H(),[a,C]=r.useState(""),[o,w]=r.useState(""),[d,E]=r.useState(3),f=s=>{const y=Math.max(1,Math.min(5,s));E(y)},[N,u]=r.useState(""),[v,l]=r.useState(""),[p,c]=r.useState(""),[m,g]=r.useState([]),[b,i]=r.useState(""),T=()=>{b.trim()&&!m.includes(b.trim())&&(g([...m,b.trim()]),i(""))},j=s=>{g(m.filter(y=>y!==s))},n=()=>{!a||!o||(I({studentId:k,sensoryType:a,response:o,intensity:d,location:p||void 0,notes:N.trim()||void 0,environment:v.trim()||void 0,copingStrategies:m.length>0?m:void 0}),C(""),w(""),E(3),c(""),u(""),l(""),g([]))};return e.jsxs(V,{className:"font-dyslexia bg-gradient-card border-0",children:[e.jsx(q,{children:e.jsx(F,{className:"text-xl text-foreground",children:String(t("sensory.title"))})}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:String(t("sensory.selectType"))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Se.map(s=>{const y=s.icon;return e.jsxs(x,{variant:a===s.type?"default":"outline",className:`h-16 flex items-center gap-3 justify-start font-dyslexia hover-lift press-scale transition-all duration-300 ${a===s.type?"bg-gradient-primary shadow-glow animate-bounce-in":"hover:scale-105 animate-fade-in hover:shadow-soft"}`,onClick:()=>C(s.type),"aria-label":`Select sensory type: ${String(t(`sensory.types.${s.type}`))}`,"aria-pressed":a===s.type,children:[e.jsx(y,{className:"h-5 w-5 transform transition-transform duration-200 hover:scale-110"}),e.jsx("div",{className:"text-left",children:e.jsx("div",{className:"font-medium",children:String(t(`sensory.types.${s.type}`))})})]},s.type)})})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:String(t("sensory.response"))}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Ne.map(s=>e.jsx(x,{variant:o===s.type?"default":"outline",className:`h-16 flex-col gap-1 font-dyslexia hover-lift press-scale transition-all duration-300 ${o===s.type?"bg-gradient-primary shadow-glow animate-bounce-in":"hover:scale-105 animate-fade-in hover:shadow-soft"}`,onClick:()=>w(s.type),"aria-label":`Select response: ${String(t(`sensory.responses.${s.type}`))}`,"aria-pressed":o===s.type,children:e.jsx("span",{className:"font-medium",children:String(t(`sensory.responses.${s.type}`))})},s.type))})]}),o&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-foreground mb-3",children:[String(t("sensory.intensity")),": ",d,"/5"]}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(s=>e.jsx(x,{variant:d===s?"default":"outline",size:"sm",className:`w-12 h-12 rounded-full font-dyslexia ${d===s?"bg-gradient-primary":""}`,onClick:()=>f(s),title:String(t(`sensory.intensityLevels.${s}`)),"aria-label":`Intensity level ${s}`,"aria-pressed":d===s,children:s},s))}),e.jsx("input",{type:"number",value:d,min:1,max:5,onChange:s=>f(Number(s.target.value)),className:"w-16 px-2 py-1 mt-2 rounded border","aria-label":"Manual intensity input"})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Body Location (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:be.map(s=>e.jsx(L,{variant:p===s?"default":"outline",className:"cursor-pointer font-dyslexia hover-lift transition-all duration-200",onClick:()=>c(p===s?"":s),role:"button",tabIndex:0,"aria-pressed":p===s,"aria-label":`Select body location: ${s}`,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),c(p===s?"":s))},children:s},s))})]}),o&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Coping Strategies Used"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:b,onChange:s=>i(s.target.value),onKeyPress:s=>s.key==="Enter"&&T(),placeholder:"Add a coping strategy...",className:"flex-1 px-3 py-2 border border-border rounded-lg font-dyslexia bg-input focus:ring-2 focus:ring-ring focus:border-transparent"}),e.jsx(x,{onClick:T,size:"sm",variant:"outline",children:String(D("buttons.add"))})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:we.map(s=>e.jsxs(L,{variant:"outline",className:"cursor-pointer font-dyslexia text-xs",onClick:()=>{m.includes(s)||g([...m,s])},children:["+ ",s]},s))}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(s=>e.jsxs(L,{variant:"secondary",className:"font-dyslexia cursor-pointer",onClick:()=>j(s),children:[s," ×"]},s))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:"Miljø (Valgfritt)"}),e.jsx("input",{type:"text",value:v,onChange:s=>l(s.target.value),placeholder:"f.eks. Klasserom, Lekeplass, Bibliotek...",className:"w-full px-3 py-2 border border-border rounded-lg font-dyslexia bg-input focus:ring-2 focus:ring-ring focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-3",children:String(t("sensory.notes"))}),e.jsx(J,{value:N,onChange:s=>u(s.target.value),placeholder:"Ytterligere observasjoner om den sensoriske responsen...",className:"font-dyslexia bg-input border-border focus:ring-ring",rows:3})]}),e.jsx(x,{onClick:n,disabled:!a||!o,className:"w-full font-dyslexia bg-gradient-primary hover:opacity-90 transition-all duration-200",children:String(t("sensory.addInput"))})]})]})},Ce=({onEnvironmentalAdd:I,studentId:k})=>{const{tTracking:t,tCommon:D}=H(),[a,C]=r.useState(22),[o,w]=r.useState(""),[d,E]=r.useState(3),[f,N]=r.useState(""),[u,v]=r.useState(""),[l,p]=r.useState(""),[c,m]=r.useState([]),[g,b]=r.useState(""),[i,T]=r.useState(""),j=()=>{g.trim()&&!c.includes(g.trim())&&(m([...c,g.trim()]),b(""))},n=h=>{m(c.filter(R=>R!==h))},s=()=>{if(!o||!f||!u||!l){toast.error("Please fill out all required fields (lighting, activity, weather, time of day).");return}const h={roomConditions:{temperature:a,lighting:o,noiseLevel:d},weather:{condition:u,temperature:a},classroom:{activity:f,timeOfDay:l},notes:i.trim()||void 0};I(h),C(22),w(""),E(3),N(""),v(""),p(""),m([]),T("")},y=o&&f&&u&&l;return e.jsxs(V,{className:"w-full",children:[e.jsx(q,{children:e.jsxs(F,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),String(t("environmental.title"))]})}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),String(t("environmental.temperature")),": ",a,"°C"]}),e.jsx(K,{value:[a],onValueChange:h=>C(h[0]),max:30,min:15,step:.5,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"15°C"}),e.jsx("span",{children:"30°C"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),String(t("environmental.lighting"))]}),e.jsxs(O,{value:o,onValueChange:w,children:[e.jsx(U,{children:e.jsx(z,{placeholder:String(t("environmental.lighting"))})}),e.jsxs(P,{children:[e.jsx(S,{value:"bright",children:String(t("environmental.lighting.bright"))}),e.jsx(S,{value:"normal",children:String(t("environmental.lighting.normal"))}),e.jsx(S,{value:"dim",children:String(t("environmental.lighting.dim"))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),String(t("environmental.noiseLevel")),": ",d,"/5"]}),e.jsx(K,{value:[d],onValueChange:h=>E(h[0]),max:5,min:1,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:String(t("environmental.levels.low"))}),e.jsx("span",{children:String(t("environmental.levels.high"))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),String(t("environmental.crowdLevel"))]}),e.jsxs(O,{value:f,onValueChange:N,children:[e.jsx(U,{children:e.jsx(z,{placeholder:String(t("environmental.crowdLevel"))})}),e.jsxs(P,{children:[e.jsx(S,{value:"low",children:String(t("environmental.levels.low"))}),e.jsx(S,{value:"moderate",children:String(t("environmental.levels.moderate"))}),e.jsx(S,{value:"high",children:String(t("environmental.levels.high"))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"text-sm font-medium text-foreground",children:String(t("environmental.notes"))}),e.jsx(J,{value:i,onChange:h=>T(h.target.value),placeholder:String(t("environmental.notesPlaceholder")),rows:3,className:"resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(A,{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),String(t("environmental.weather"))]}),e.jsxs(O,{value:u,onValueChange:v,children:[e.jsx(U,{children:e.jsx(z,{placeholder:String(t("environmental.weather"))})}),e.jsxs(P,{children:[e.jsx(S,{value:"sunny",children:String(t("environmental.weatherOptions.sunny"))}),e.jsx(S,{value:"cloudy",children:String(t("environmental.weatherOptions.cloudy"))}),e.jsx(S,{value:"rainy",children:String(t("environmental.weatherOptions.rainy"))}),e.jsx(S,{value:"snowy",children:String(t("environmental.weatherOptions.snowy"))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"text-sm font-medium text-foreground",children:String(t("environmental.timeOfDay"))}),e.jsxs(O,{value:l,onValueChange:p,children:[e.jsx(U,{children:e.jsx(z,{placeholder:String(t("environmental.timeOfDay"))})}),e.jsxs(P,{children:[e.jsx(S,{value:"morning",children:String(t("environmental.timeOfDayOptions.morning"))}),e.jsx(S,{value:"afternoon",children:String(t("environmental.timeOfDayOptions.afternoon"))}),e.jsx(S,{value:"evening",children:String(t("environmental.timeOfDayOptions.evening"))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"text-sm font-medium text-foreground",children:String(t("environmental.specialEvents"))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:h=>b(h.target.value),placeholder:String(t("environmental.specialEventsPlaceholder")),className:"flex-1 px-3 py-2 border border-border rounded-md bg-input text-sm",onKeyPress:h=>h.key==="Enter"&&j()}),e.jsx(x,{onClick:j,size:"sm",type:"button",children:e.jsx(re,{className:"h-4 w-4"})})]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map((h,R)=>e.jsxs(L,{variant:"secondary",className:"flex items-center gap-2",children:[h,e.jsx(oe,{className:"h-3 w-3 cursor-pointer",onClick:()=>n(h)})]},R))})]}),e.jsxs(x,{onClick:s,disabled:!y,className:"w-full",children:[String(D("buttons.save"))," ",String(t("environmental.title"))]})]})]})},ns=()=>{const{studentId:I}=Y(),k=Q(),[t,D]=r.useState(null),[a,C]=r.useState([]),[o,w]=r.useState([]),[d,E]=r.useState(null),[f,N]=r.useState(""),[u,v]=r.useState(!1),{tTracking:l,tCommon:p}=H();r.useEffect(()=>{if(!I)return;const i=localStorage.getItem("sensoryTracker_students");if(i){const j=JSON.parse(i).find(n=>n.id===I);j?D({...j,createdAt:new Date(j.createdAt)}):($.error(String(l("session.validationError"))),k("/"))}},[I,k,l]);const c=i=>{C([...a,i]),$.success("Emotion recorded!")},m=i=>{w([...o,i]),$.success("Sensory input recorded!")},g=i=>{E(i),$.success("Environmental conditions recorded!")},b=async()=>{if(t){if(a.length===0&&o.length===0){$.error(String(l("session.validationError")));return}v(!0);try{const i=new Date,T={id:crypto.randomUUID(),studentId:t.id,timestamp:i,emotions:a.map(s=>({...s,id:crypto.randomUUID(),timestamp:i})),sensoryInputs:o.map(s=>({...s,id:crypto.randomUUID(),timestamp:i})),environmentalData:d?{...d,id:crypto.randomUUID(),timestamp:i}:void 0,notes:f.trim()||void 0},j=localStorage.getItem("sensoryTracker_entries"),n=j?JSON.parse(j):[];n.push(T),localStorage.setItem("sensoryTracker_entries",JSON.stringify(n)),await de.triggerAnalyticsForStudent(t),$.success(String(l("session.sessionSaved"))),k(`/student/${t.id}`)}catch(i){_.error("Failed to save tracking session",{error:i}),$.error(String(l("session.saveError")))}finally{v(!1)}}};return t?e.jsx("div",{className:"min-h-screen bg-background font-dyslexia",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(x,{variant:"ghost",onClick:()=>k(`/student/${t.id}`),className:"font-dyslexia",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),String(p("buttons.back"))]}),e.jsx(le,{})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-primary flex items-center justify-center text-primary-foreground font-semibold text-lg",children:t.name.split(" ").map(i=>i[0]).join("").toUpperCase()}),e.jsx("div",{children:e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:String(l("session.title")).replace("{{studentName}}",t.name)})})]}),e.jsx("p",{className:"text-muted-foreground",children:"Record emotions and sensory responses for this session"})]}),e.jsxs("div",{className:"mb-6 p-4 bg-primary-soft rounded-lg border border-primary/20",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-foreground mb-2",children:String(l("session.summary"))}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-primary-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:String(l("session.emotionsRecorded")).replace("{{count}}",a.length.toString())})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:String(l("session.sensoryInputsRecorded")).replace("{{count}}",o.length.toString())})})]})]}),e.jsxs("div",{className:"space-y-8 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(je,{onEmotionAdd:c,studentId:t.id}),e.jsx(ke,{onSensoryAdd:m,studentId:t.id})]}),e.jsx("div",{className:"w-full",children:e.jsx(Ce,{onEnvironmentalAdd:g,studentId:t.id})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-3",children:String(l("session.generalNotes"))}),e.jsx("textarea",{value:f,onChange:i=>N(i.target.value),placeholder:String(l("session.generalNotesPlaceholder")),className:"w-full p-4 border border-border rounded-lg font-dyslexia bg-input focus:ring-2 focus:ring-ring focus:border-transparent resize-none",rows:4})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(x,{variant:"ghost",onClick:()=>k(`/student/${t.id}`),className:"flex-1 font-dyslexia",children:String(l("session.cancelSession"))}),e.jsx(x,{onClick:b,disabled:u||a.length===0&&o.length===0,className:"flex-1 font-dyslexia bg-gradient-primary hover:opacity-90 transition-all duration-200",children:u?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),String(p("status.saving"))]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),String(l("session.saveSession"))]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsxs("p",{className:"text-muted-foreground",children:[String(p("status.loading")),"..."]})]})})};export{ns as default};
